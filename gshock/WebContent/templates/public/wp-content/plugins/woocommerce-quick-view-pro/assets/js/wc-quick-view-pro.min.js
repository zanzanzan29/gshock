/*!
 * WooCommerce Quick View Pro 1.6.8
 * Copyright 2021 Barn2 Plugins
 */
! function(e, t, o, i, n) {
    "use strict";
    if (!e.fn.jQueryModal || void 0 === i) return !1;
    let a = function(n) {
        Number(i.debug);
        const a = ".wc-quick-view-modal",
            c = {
                escapeClose: !1,
                clickClose: !1,
                showClose: !1
            },
            r = e('<div class="' + e.modal.defaults.modalClass + '-spinner"></div>').append(e.modal.defaults.spinnerHtml),
            s = e("html");
        let l, d = null,
            u = !1,
            _ = !1;

        function p(e) {
            t.dontCloseQVP = !0
        }

        function f(e) {
            _ = !0
        }

        function m(e) {
            "Escape" !== e.key || l.hasClass("pswp--open") || (t.dontCloseQVP = !1, w()), "Escape" === e.key && (_ || l.hasClass("pswp--open")) && (_ = !1, t.dontCloseQVP = !1)
        }

        function w(i) {
            if (_ && !l.hasClass("pswp--open")) return _ = !1, t.dontCloseQVP = !0, void setTimeout((function() {
                t.dontCloseQVP = !1
            }), 100);
            if (t.dontCloseQVP) setTimeout((function() {
                t.dontCloseQVP = !1
            }), 100);
            else if (u) {
                let n = i ? e(i.target).closest(a) : [];
                i && "qvp-modal:close" !== e(i.target).attr("rel") && 0 !== n.length || (i && (i.preventDefault(), i.stopPropagation()), e(o.body).trigger("quick_view_pro:closed"), e.modal.close(), _ = !1, t.dontCloseQVP = !1)
            }
        }

        function g(t, n) {
            if (t = parseInt(t, 10), n = n || [], !t) return !1;
            if (n.data("clicked")) return !1;
            n.data("clicked", !0);
            let a = e("#quick-view-" + t);
            return a.length ? (a.jQueryModal(c), n.data("clicked", !1), u = !0) : (e(o.body).trigger("quick_view_pro:before_open", [t]), e.ajax({
                url: i.rest_url + "/" + i.rest_endpoints.view + "/" + t,
                method: "GET",
                dataType: "json",
                beforeSend: function(e) {
                    e.setRequestHeader("X-WP-Nonce", i.rest_nonce)
                }
            }).done((function(n, a, r) {
                const s = r.getResponseHeader("X-WP-Nonce");
                if (s && (i.rest_nonce = s), !("quick_view" in n)) return void e(o.body).trigger("quick_view_pro:open_fail", [t]);
                e(n.quick_view).jQueryModal(c);
                const l = e.modal.getCurrent();
                l.$elm.append(e('<a href="#close-modal" rel="qvp-modal:close" class="close-modal">Close</a>')), l && l.$elm.trigger("quick_view_pro:load", [l.$elm])
            })).fail((function(i, n, a) {
                e(o.body).trigger("quick_view_pro:open_fail", [t])
            })).always((function() {
                n.data("clicked", !1), e(o.body).trigger("quick_view_pro:open_complete", [t])
            }))), !0
        }

        function v(e, t) {
            e && t && e.length && e.append(`<div class="wc-quick-view-notice error-notice">${t}</div>`)
        }

        function h(e) {
            e.find(".wc-quick-view-notice, .wc-quick-view-success-wrap").remove()
        }

        function k(t) {
            let o = t.find(".cart");
            if (!o.length) return;
            let i = o.find('input[name^="quantity"]');
            i.length && i.val(i.attr("value")), o.find("select").each(((t, o) => {
                e(o).val(e(o).find("option:selected").val())
            }));
            let n = o.find(".wc-pao-addon");
            n.length && (n.find("input").each((function() {
                let t = e(this).attr("type");
                "checkbox" === t || "radio" === t ? e(this).prop("checked", !1) : e(this).val(""), e(this).change()
            })), n.find("select").find("option:first").prop("selected", !0).change(), n.find("textarea").val("").change())
        }

        function q(t) {
            let o = e(t.currentTarget),
                i = o.data("product_id") || 0;
            if (o.closest(".qvp-disabled").length) return !0;
            if (!i) {
                let e = o.closest(".product");
                if (!e.length) return !0;
                if (i = e.find("[data-product_id]").data("product_id"), !i) {
                    const t = e.attr("class").match(/post\-(\d+)/);
                    1 in t && (i = t[1])
                }
                if (!i) return !0
            }
            return o.blur(), g(i, o), t.preventDefault(), t.stopPropagation(), !1
        }

        function b() {
            r.appendTo(o.body).show()
        }

        function y() {
            r.remove(), u = !0
        }

        function C(e, t) {
            t.$elm.trigger("quick_view_pro:open", [t.$elm])
        }

        function P(e, t) {
            t.$elm.trigger("quick_view_pro:close", [t.$elm]), u = !1
        }

        function Q(e, t) {
            s.addClass("qvp-modal-is-open"), t.find(".cart").length && (h(t), k(t))
        }

        function V(e, t) {
            s.removeClass("qvp-modal-is-open"),
                function(e) {
                    e.find(".mejs-container").find("audio, video").each((function() {
                        this.pause && this.pause()
                    }))
                }(t), d && (clearTimeout(d), d = null)
        }

        function j(o, n) {
            ! function(o) {
                o.find(".wc-quick-view-product-summary").length && (function(t) {
                    e.fn.wc_variation_form && t.find(".variations_form").each((function() {
                        e(this).wc_variation_form()
                    })).on("woocommerce_variation_has_changed", (function() {
                        let t = e('input[name="variation_id"]', this);
                        t.length && "" === t.val() && t.val("0")
                    })).on("reset_data", (function() {
                        h(t)
                    }))
                }(o), function(e) {
                    void 0 !== t.WPPlaylistView && e.find(".wp-playlist:not(:has(.mejs-container))").each((function() {
                        new t.WPPlaylistView({
                            el: this
                        })
                    })), "mediaelement" in t.wp && t.wp.mediaelement.initialize()
                }(o), function(t) {
                    e.fn.productTable && t.find(".wc-product-table").productTable(), t.find(".cart").length && (t.trigger("quick-view-displayed"), e.fn.wc_pb_bundle_form && t.find(".bundle_form .bundle_data").each((function() {
                        let t = e(this);
                        t.closest(".composite_form").length || t.wc_pb_bundle_form()
                    })), e.fn.wc_composite_form && t.find(".composite_form .composite_data").each((function() {
                        e(this).wc_composite_form()
                    })))
                }(o)), o.find(".wc-quick-view-product-gallery").length && function(t) {
                    if (!e.fn.wc_product_gallery) return;
                    let o = t.find(".woocommerce-product-gallery");
                    if (o.length) {
                        var n = !1 !== wc_single_product_params.flexslider_enabled;
                        wc_single_product_params.flexslider_enabled = !0, wc_single_product_params.flexslider_enabled = !0, wc_single_product_params.flexslider.controlNav = i.navStyle, o.first().wc_product_gallery(wc_single_product_params), wc_single_product_params.flexslider_enabled = n;
                        let e = t.data("imageWidth");
                        e && (t.hasClass("with-thumbnail") && !t.hasClass("with-details") && t.css("max-width", e + "px"), o.css("width", e + "px"))
                    }
                }(o), o.find(".wc-quick-view-product-tabs").length && e(".wc-tabs-wrapper, .woocommerce-tabs").trigger("init")
            }(n)
        }

        function x() {
            e('<div class="wc-quick-view-modal wc-quick-view-error wc-quick-view-message-only"><p>' + i.messages.open_error + "</p></div>").jQueryModal(c)
        }

        function $(n) {
            let c = e(n.target),
                r = c.closest(a),
                s = c.find(".single_add_to_cart_button") || [];
            if (s.length || (s = c.find('button[type="submit"]')), s.hasClass("loading") || s.hasClass("disabled")) return !1;
            if (h(r), r.hasClass("external-product")) return t.location.href = c.attr("action"), !1;
            let l = function(t) {
                    let o = function(e) {
                            let t = function(e) {
                                    const t = {},
                                        o = e.serializeArray();
                                    for (const e of o) {
                                        let o = e.name.match(/quantity\[(\d+)]/);
                                        o ? (t.quantity || (t.quantity = {}), t.quantity[Number(o[1])] = Number(e.value)) : (o = e.name.match(/(addon.*)\[(\d*)]/), o ? (t[o[1]] || (t[o[1]] = []), t[o[1]].push(e.value)) : t[e.name] = e.value)
                                    }
                                    return t
                                }(e),
                                o = e.find('[name="add-to-cart"]').val();
                            return delete t["add-to-cart"], t.product_id = o, t
                        }(t),
                        n = {
                            isValid: !1,
                            message: !1,
                            cartData: null
                        };
                    return e.isEmptyObject(o) ? (n.message = i.messages.cart_error, n) : "product_id" in o || t.closest(".wc-quick-view-modal.has-bulk-variations").length ? 0 === o.quantity || Object.prototype.isPrototypeOf(o.quantity) && 0 === Object.values(o.quantity).reduce(((e, t) => e + Number(t)), 0) ? (n.message = i.messages.zero_quantity, n) : "variation_id" in o && 0 === parseInt(o.variation_id, 10) ? (n.message = i.messages.option_required, n) : (e(":input", t).each((function() {
                        let t = e(this).prop("name");
                        if (e(this).prop("required") && (!(t in o) || "" === o[t])) return n.message = i.messages.option_required, n
                    })), n.message || (n.isValid = !0), n.cartData = o, n) : (n.message = i.messages.no_product_id, n)
                }(c),
                u = l.cartData;
            return l.isValid ? (r.trigger("quick_view_pro:before_add_to_cart", [u]), t.wc_fast_cart_params && wc_fast_cart_params.options.autoOpen || (s.addClass("loading"), e(o.body).trigger("adding_to_cart", [s, u]), e.ajax({
                url: i.rest_url + "/" + i.rest_endpoints.cart,
                type: "POST",
                data: u,
                dataType: "json",
                beforeSend: function(e) {
                    e.setRequestHeader("X-WP-Nonce", i.rest_nonce)
                }
            }).done((function(i, n, a) {
                i.error ? v(c, i.error) : wc_add_to_cart_params && "yes" === wc_add_to_cart_params.cart_redirect_after_add ? t.location = wc_add_to_cart_params.cart_url : i.cart_message && (r.append(e('<div class="wc-quick-view-success-wrap" />').append(`<p class="wc-quick-view-notice success-notice">${i.cart_message}</p>`)), r.trigger("quick_view_pro:added_to_cart", [i]), e(o.body).trigger("added_to_cart", [i.fragments, i.cart_hash]), d = setTimeout((function() {
                    k(r), e(o.body).trigger("quick_view_pro:closed"), e.modal.close()
                }), 1500))
            })).fail((function() {
                r.trigger("quick_view_pro:add_to_cart_fail", [u])
            })).always((function() {
                s.removeClass("loading"), r.trigger("quick_view_pro:add_to_cart_complete", [u])
            }))), !1) : (v(c, l.message), !1)
        }

        function T() {
            const t = e.modal.getCurrent();
            t && (e(o).off("keydown.modal"), t.$elm.find("a.close-modal").attr("rel", ""))
        }

        function E() {
            const t = e.modal.getCurrent();
            t && (e(o).on("keydown.modal", (function(i) {
                27 === i.which && t.options.escapeClose && (e(o.body).trigger("quick_view_pro:closed"), t.close())
            })), t.$elm.find("a.close-modal").attr("rel", "qvp-modal:close"))
        }

        function O(t, o) {
            v(e(t.target).find(".cart"), i.messages.cart_error)
        }
        return t.dontCloseQVP = !1, {
            initialize: function() {
                l = e(".pswp"), e(o.body).on("click", w).on("keydown", m).on("click", 'a[rel="qvp-modal:close"]', w).on("click", '[data-action="quick-view"]', q).on("quick_view_pro:before_open", b).on("quick_view_pro:open_complete", y).on(e.modal.BEFORE_OPEN, a, C).on(e.modal.BEFORE_CLOSE, a, P).on("quick_view_pro:load", j).on("quick_view_pro:open", Q).on("quick_view_pro:close", V).on("quick_view_pro:open_fail", x).on("quick_view_pro:before_add_to_cart", T).on("quick_view_pro:add_to_cart_complete", E).on("submit", `${a} .cart, ${a} .wcbvp-cart`, $).on("quick_view_pro:add_to_cart_fail", O).on("click", ".woocommerce-product-gallery__trigger", f).on("updated_checkout", w), l.on("click", p), e(".wcbvp-variation-pool-item .action-delete").on("click", p), i.enable_product_link && i.product_link_selector && e(o.body).on("click", i.product_link_selector, q), t.wp = t.wp || {}
            },
            openQuickView: g,
            handleQuickViewClick: q
        }
    }();
    t.WCQuickViewPro = a, e((() => {
        a.initialize()
    }))
}(jQuery, window, document, wc_quick_view_pro_params);